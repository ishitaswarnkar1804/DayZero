<!DOCTYPE html>
<html lang="en" data-theme="pastel">
<head>
  <meta charset="UTF-8">
  <title>DayZero — Study With Me</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <style>
    .room{
      max-width: 1400px;
      margin: 0 auto;
      display:grid;
      grid-template-columns: 2fr 1fr;
      gap:18px;
    }
    .video-card{
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .player-wrap{
      position:relative;
      width:100%;
      padding-top:56.25%;
      border-radius:20px;
      overflow:hidden;
      background:#000;
      box-shadow:0 18px 50px rgba(0,0,0,.15);
    }
    .player-wrap iframe{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      border:0;
    }
    .yt-bar{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
    }
    .yt-bar input{flex:1;min-width:220px}

    .notes{
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .notes textarea{
      width:100%;
      height:320px;
      border-radius:16px;
      padding:14px;
      resize:none;
      border:none;
      outline:none;
      background:rgba(255,255,255,.75);
      font-family:inherit;
      line-height:1.5;
    }
    .focus-btn{
      display:none;
    }

    @media(max-width:900px){
      .room{grid-template-columns:1fr}
      .notes textarea{height:220px}
      .focus-btn{
        display:inline-block;
      }
      body.focus-mode .notes{
        display:none;
      }
      body.focus-mode .player-wrap{
        height:calc(100vh - 120px);
        padding-top:0;
      }
      body.focus-mode .player-wrap iframe{
        position:absolute;
        inset:0;
      }
    }
  </style>
</head>
<body>
  <div class="overlay">
    <header>
      <div>
        <div class="brand">Study With Me</div>
        <div class="tagline">A quiet companion while you work.</div>
      </div>
      <div>
        <button id="focusBtn" class="link focus-btn">Focus Mode</button>
        <a href="index.html" class="link">Back</a>
      </div>
    </header>

    <div class="room">

      <!-- VIDEO -->
      <div class="card video-card">
        <div class="yt-bar">
          <input id="ytInput" placeholder="Paste a YouTube study video link…">
          <button id="loadBtn" class="link">Load</button>
        </div>

        <div class="player-wrap">
          <iframe id="player" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>

        <div class="hint" style="font-size:.85rem;opacity:.7">
          Try “study with me 2 hours” on YouTube.
        </div>
      </div>

      <!-- NOTES -->
      <div class="card notes">
        <h3>Session Notes</h3>
        <input id="noteName" placeholder="Name this note…" style="margin-bottom:4px">
        <textarea id="noteBox" placeholder="Write what you’re studying, thoughts, formulas…"></textarea>
        <button id="saveNote" class="link">Save to Notes Vault</button>
        <div id="msg" class="hint"></div>
      </div>

    </div>
  </div>

  <script>
    const t = localStorage.getItem("dayzero-theme") || "pastel";
    document.documentElement.setAttribute("data-theme", t);

    const ytInput = document.getElementById("ytInput");
    const loadBtn = document.getElementById("loadBtn");
    const player = document.getElementById("player");

    const noteBox = document.getElementById("noteBox");
    const noteName = document.getElementById("noteName");
    const saveNote = document.getElementById("saveNote");
    const msg = document.getElementById("msg");

    const focusBtn = document.getElementById("focusBtn");

    let activeKey = null;

    function extractID(url){
      try{
        const u = new URL(url);
        if(u.hostname.includes("youtu.be")){
          return u.pathname.slice(1);
        }
        return u.searchParams.get("v");
      }catch(e){
        return null;
      }
    }

    function loadVideo(url){
      const id = extractID(url);
      if(!id) return;

      const embed = `https://www.youtube.com/embed/${id}?rel=0`;
      player.src = embed;

      activeKey = `study-${id}`;
      noteBox.value = localStorage.getItem(activeKey + "-body") || "";
      noteName.value = localStorage.getItem(activeKey + "-title") || "";

      localStorage.setItem("dayzero-study-video", url);
    }

    loadBtn.onclick = () => {
      if(!ytInput.value.trim()) return;
      loadVideo(ytInput.value.trim());
    };

    // Autosave while typing
    noteBox.oninput = () => {
      if(activeKey){
        localStorage.setItem(activeKey + "-body", noteBox.value);
      }
    };

    noteName.oninput = () => {
      if(activeKey){
        localStorage.setItem(activeKey + "-title", noteName.value);
      }
    };

    saveNote.onclick = () => {
      if(!activeKey){
        msg.textContent = "Load a video first.";
        return;
      }
      if(!noteName.value.trim()){
        msg.textContent = "Give your notes a name.";
        return;
      }

      const key = noteName.value.trim() + "-notes";
      localStorage.setItem(key, noteBox.value);

      msg.textContent = "Saved to Notes Vault.";
      setTimeout(()=>msg.textContent="",1200);
    };

    const last = localStorage.getItem("dayzero-study-video");
    if(last){
      ytInput.value = last;
      loadVideo(last);
    }

    focusBtn.onclick = () => {
      document.body.classList.toggle("focus-mode");
      focusBtn.textContent = document.body.classList.contains("focus-mode")
        ? "Exit Focus"
        : "Focus Mode";
    };
  </script>
</body>
</html>
