<!DOCTYPE html>
<html lang="en" data-theme="pastel">
<head>
  <meta charset="UTF-8">
  <title>DayZero — Notes Vault</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#e8f6ec">
  <link rel="stylesheet" href="style.css">
  <style>
    .notes-wrap{
      display:grid;
      grid-template-columns: 280px 1fr;
      gap:18px;
      height: calc(100vh - 140px);
    }
    .notes-list{
      overflow:auto;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .note-item{
      padding:10px 12px;
      border-radius:10px;
      cursor:pointer;
      font-size:.9rem;
      opacity:.85;
    }
    .note-item.active{
      background: rgba(0,0,0,.06);
      opacity:1;
    }
    .editor{
      display:flex;
      flex-direction:column;
      height:100%;
    }
    .editor textarea{
      flex:1;
      border:none;
      outline:none;
      resize:none;
      padding:14px;
      border-radius:14px;
      background: rgba(255,255,255,.7);
      font-family: inherit;
      font-size:.95rem;
    }
    .editor-top{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:8px;
      gap:10px;
    }
    .search{
      margin-bottom:6px;
    }
    .search input{
      width:100%;
      padding:8px 10px;
      border-radius:10px;
      border:none;
      outline:none;
      background: rgba(255,255,255,.65);
      font-family: inherit;
      font-size:.85rem;
    }
    @media(max-width:800px){
      .notes-wrap{grid-template-columns:1fr;height:auto}
    }
  </style>
</head>
<body>
  <div class="overlay">
    <header>
      <div>
        <div class="brand">Notes Vault</div>
        <div class="tagline">Your external brain</div>
      </div>
      <a href="index.html" class="link">Back</a>
    </header>

    <div class="notes-wrap">

      <!-- LEFT: LIST -->
      <div class="card">
        <div class="search">
          <input id="search" placeholder="Search notes…">
        </div>
        <div class="notes-list" id="list"></div>
      </div>

      <!-- RIGHT: EDITOR -->
      <div class="card editor">
        <div class="editor-top">
          <div id="title" style="font-weight:600;opacity:.8">Select a note</div>
          <button id="deleteBtn" class="link" style="display:none">Delete</button>
        </div>
        <textarea id="body" placeholder="Your note will appear here…" disabled></textarea>
      </div>

    </div>
  </div>

  <script>
    // Global theme sync
    const savedTheme = localStorage.getItem("dayzero-theme") || "pastel";
    document.documentElement.setAttribute("data-theme", savedTheme);

    const list = document.getElementById("list");
    const titleEl = document.getElementById("title");
    const body = document.getElementById("body");
    const deleteBtn = document.getElementById("deleteBtn");
    const search = document.getElementById("search");

    let activeKey = null;
    let allKeys = [];

    function getAllNotes(){
      return Object.keys(localStorage)
        .filter(k => k.endsWith("-notes"))
        .sort();
    }

    function renderList(filter=""){
      list.innerHTML = "";
      const keys = allKeys.filter(k =>
        k.replace("-notes","").toLowerCase().includes(filter.toLowerCase())
      );

      if(!keys.length){
        list.innerHTML = `<div style="opacity:.6;font-size:.9rem">No notes found.</div>`;
        return;
      }

      keys.forEach(k=>{
        const div = document.createElement("div");
        div.className = "note-item" + (k === activeKey ? " active" : "");
        div.textContent = k.replace("-notes","");
        div.onclick = ()=> openNote(k);
        list.appendChild(div);
      });
    }

    function openNote(key){
      activeKey = key;
      titleEl.textContent = key.replace("-notes","");
      body.value = localStorage.getItem(key) || "";
      body.disabled = false;
      deleteBtn.style.display = "inline-block";
      renderList(search.value);
    }

    body.oninput = () => {
      if(!activeKey) return;
      localStorage.setItem(activeKey, body.value);
    };

    deleteBtn.onclick = () => {
      if(!activeKey) return;
      localStorage.removeItem(activeKey);
      activeKey = null;
      titleEl.textContent = "Select a note";
      body.value = "";
      body.disabled = true;
      deleteBtn.style.display = "none";
      load();
    };

    function load(){
      allKeys = getAllNotes();
      renderList(search.value);
    }

    search.oninput = () => {
      renderList(search.value);
    };

    load();
  </script>
</body>
</html>
